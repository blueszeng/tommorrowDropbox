var BaseModel,MysqlModel,loadMySqlModel,extend=function(t,r){function e(){this.constructor=t}for(var n in r)hasProp.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t},hasProp={}.hasOwnProperty;BaseModel=require("./basemodel"),loadMySqlModel=require("./baseinit".loadMySqlModel),MysqlModel=function(t){function r(t,e){r.__super__.constructor.call(this,t(e(loadMySqlModel)))}return extend(r,t),r.prototype.order=function(t){var r,e,n,o;for(o="",e=0,n=t.length;n>e;e++)r=t[e],o+=r+" "+t[r]+" ";return this.params.order=o},r.prototype.findAll=function(){var t;return t=this,this.action=function(r){return t.Model.findAll({where:t.params.where,limit:t.params.limit,offset:t.params.offset,attributes:t.params.fields,order:t.params.order,raw:t.params.raw}).then(function(t){return r(null,t)})["catch"](function(t){return r(t)})},this},r.prototype.findById=function(t){var r;return r=this,this.action=function(e){return r.params.where=r.params.where||{},r.params.where.id=t,r.Model.find({where:r.params.where,attributes:r.params.fields,order:r.params.order,raw:r.params.raw}).then(function(t){return e(null,t)})["catch"](function(t){return e(t)})},this},r.prototype.findByField=function(t,r){var e;return e=this,this.action=function(n){return e.params.where=e.params.where||{},e.params.where[t]=r,e.Model.find({where:e.params.where,attributes:e.params.fields,order:e.params.order,raw:e.params.raw}).then(function(t){return n(null,t)})["catch"](function(t){return n(t)})},this},r.prototype.count=function(){var t;return t=this,this.action=function(r){return t.Model.count({where:t.params.where}).then(function(t){return r(null,t)})["catch"](function(t){return r(t)})},this},r.prototype.add=function(t){var r;return r=this,this.action=function(e){return r.Model.create(t).then(function(){return e(null,data)})["catch"](function(t){return e(t)})},this},r.prototype.update=function(t){var r;return r=this,this.action=function(e){var n,o,a,u,i;if(r.result){for(n=a=i=null,n=[],o=0,u=data.length;u>o;o++)a=data[o],i=data[a],r.Model.rawAttributes[a]&&n.push(a);r.result.updateAttributes(t,n).then(function(t){return e(null,t)})["catch"](function(t){return e(t)})}else r.Model.update(t,r.params.where)["catch"](function(){return e()});return this}},r.prototype["delete"]=function(){var t;return t=this,this.action=function(r){return t.result?t.result.destroy().then(function(t){return r(null,t)})["catch"](function(t){return r(t)}):t.Model.destroy(t.params.where).then(function(){return r()}),this}},r.prototype.addCount=function(t){var r;return r=this,this.action=function(e){var n;return r.result?(n={},n[t]=1*r.result[t]+1,r.result.updateAttributes(n,[t]).then(function(t){return e(null,t)})["catch"](function(t){return e(t)})):e(new Error("先调用findBy再调用addCount，please")),this}},r}(BaseModel),module.exports=MysqlModel;